{% extends 'base.html' %}
{% block content %}
<section>
    <h2>Ask Sita</h2>
    <form id="chat-form">
        <label for="question">Ask a question:</label>
        <input type="text" id="question" name="question" required>
        <button type="submit">Send</button>
    </form>
    <div id="loading" style="display:none;">Processing...</div>
    <div id="chat-response"></div>
</section>
<script>
    document.getElementById('chat-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const question = document.getElementById('question').value;
        
        // Show loading indicator
        document.getElementById('loading').style.display = 'block';
        document.getElementById('chat-response').innerText = '';

        fetch('/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `question=${question}`
        })
        .then(response => response.json())
        .then(data => {
            // Hide loading indicator
            document.getElementById('loading').style.display = 'none';
            document.getElementById('chat-response').innerText = 'Chatbot: ' + data.response;
        })
        .catch(error => {
            // Hide loading indicator
            document.getElementById('loading').style.display = 'none';
            document.getElementById('chat-response').innerText = 'An error occurred. Please try again.';
        });
    });
</script>
{% endblock %}
